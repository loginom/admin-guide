# Установка Loginom Adapter

## Подготовка к установке

Перед установкой *Адаптера* необходимо:

1. Включить компоненты:
   * .Net Framework 3.5.
   * .Net Framework 4.5.
   * Microsoft Internet Information Server (IIS).
1. Дополнительно необходимо включить:
   * IIS -> Management Tools -> IIS 6 Management Compatibility.
   * .NET Framework 4.5 -> WCF Services -> HTTP Activation.
1. Создать и настроить [особую учетную запись](./special-user.md).
1. [Настроить IIS](./iis-config.md).
1. При необходимости следует установить опциональное программное обеспечение:
   * Криптопровайдер — если использование *Адаптера* подразумевает использование шифрования.
   * Java Runtime Environment — если это необходимо для подключения к конкретному веб-сервису.

## Установка MSI

Имя установочного файла состоит из названия и версии продукта: `LoginomAdapter_6.x.x.msi`, где 6.x.x — цифры, обозначающие версию и релиз программы.

> Примечание: при запуске программы установщика *Адаптера* может появится информационное окно с сообщением: `отсутствуют необходимые права… Войдите в систему под именем администратора…`. В этом случае следует запустить установщик из командной строки (**command prompt**), запущенной от имени администратора (ПКМ по ярлыку командной строки, после чего выбрать **Run as Administrator**).

Если во время подготовки все было настроено верно, появится окно установщика.

На странице **Выбор адреса для установки** назначаем следующие значения параметров:

![ ](../../images/adapter-setup-page.png)

* **Веб-узел** — по умолчанию `Default Web Site` (можно задать другой, созданный в диспетчере служб IIS);
* **Виртуальный каталог** — имя каталога, где будет размещено установленное приложение (по умолчанию, `LoginomAdapter`);
* **Пул приложений** — выбираем созданный в диспетчере служб IIS пул, например, `LoginomAdapterAppPool`.

По умолчанию путь будет `C:\inetpub\wwwroot\LoginomAdapter\`.

> Примечание: компьютер, на котором работает *Адаптер*, должен иметь сетевой доступ к внешним сервисам.

## Настройка лицензии Loginom Adapter

Для работы *Адаптера* требуется настройка [ключей лицензирования](../../licenses/README.md).

При использовании сервера сетевых ключей требуется создать и отредактировать файл [GnClient.ini](https://dev.guardant.ru/pages/viewpage.action?pageId=1277980) в каталоге `"C:\ProgramData\BaseGroup\Loginom 6\Adapter"`.

## Проверка работоспособности

Для проверки работоспособности необходимо в браузере перейти по URL: `http://<Server>/LoginomAdapter/Service.svc?wsdl`, где `<Server>` — имя хоста Loginom Adapter.

Пример: `http://localhost/LoginomAdapter/service.svc?wsdl`

*Адаптер* должен отдать WSDL SOAP веб-сервиса с сообщением наподобие:

```xml
<wsdl:definitions xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" …>
…
</wsdl:definitions>
```

## Перенос приложения Loginom Adapter на другой компьютер

Перенос/копирование развернутого приложения *Адаптера* на другой компьютер можно сделать без использования дистрибутива, перенеся каталог установки ранее развернутого приложения в каталог существующего сайта IIS на другом компьютере. Если используется созданный по умолчанию сайт `DefaultWebSite`, то перенос осуществляется в папку `C:\inetpub\wwwroot`. После этого папка приложения будет отображена в оснастке IIS, в группе `сайты` -> `Default Web Site`, где ее необходимо преобразовать в приложение. Это можно сделать при помощи соответствующего пункта контекстного меню — **Преобразовать в приложение**. В открывшемся окне нужно выбрать заранее созданный пул приложений, например,  `LoginomAdapterAppPool`.

Если веб-сервис не запущен, то необходимо запустить его с помощью контекстного меню в диспетчере служб IIS.

> Важно: Перенос приложения *Адаптера* должен осуществляться на компьютер с выполненной [Подготовкой к установке](./#podgotovka-k-ustanovke).
